(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-workbench-task-TaskFormDetail"],{"13bf":function(t,e,a){"use strict";a.r(e);var s=a("d8784"),i=a("ed54");for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("b608");var r,o=a("f0c5"),c=Object(o["a"])(i["default"],s["b"],s["c"],!1,null,"123278d2",null,!1,s["a"],r);e["default"]=c.exports},"28e5":function(t,e,a){var s=a("6c81");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("4f06").default;i("43313d22",s,!0,{sourceMap:!1,shadowMode:!1})},"6c81":function(t,e,a){var s=a("24fb");e=s(!1),e.push([t.i,"uni-page-body[data-v-123278d2]{padding-top:45px}.cu-form-group .title[data-v-123278d2]{min-width:calc(4em + 40px)}",""]),t.exports=e},"880d":function(t,e,a){"use strict";var s=a("ee27");a("4de4"),a("4160"),a("26e9"),a("e25e"),a("8a79"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=s(a("c964")),n=s(a("e812")),r=s(a("f46a")),o=s(a("d3ce")),c={onLoad:function(t){this.flow=JSON.parse(decodeURIComponent(t.flow)),this.procDefId=this.flow.procDefId,this.procDefKey=this.flow.procDefKey,this.formType=this.flow.formType,this.formUrl=this.flow.formUrl,this.taskId=this.flow.taskId,this.taskDefKey=this.flow.taskDefKey,this.status=this.flow.status,this.title=this.flow.formTitle,this.businessId=this.flow.businessId,this.procInsId=this.flow.procInsId,this.formReadOnly=!0},mounted:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("2"!==t.formType){e.next=4;break}"/404"===t.formUrl?(t.form=null,uni.showToast({title:"没有关联流程表单!",icon:"none"})):t.formUrl.endsWith("TestActivitiLeaveForm")?t.form=o.default:uni.showToast({title:"没有关联流程表单!",icon:"none"}),e.next=17;break;case 4:if("/404"!==t.formUrl){e.next=8;break}uni.showToast({title:"没有关联流程表单!",icon:"none"}),e.next=17;break;case 8:return e.next=10,t.$http.get("/app/flowable/form/getMobileForm?formDefinitionJsonId="+t.formUrl);case 10:return a=e.sent,s=a.data,s.formStructure.forEach((function(e){e.writable=!0,e.readable=!0,t.isObjectValue(e)?e.value=null:e.value="";var a=JSON.parse(JSON.stringify(e));t.formData.push(a)})),e.next=15,t.$http.get("/app/flowable/form/getHistoryTaskFormData",{processInstanceId:t.procInsId,procDefId:t.procDefId,taskDefKey:t.taskDefKey});case 15:i=e.sent,t.setData(i.data.taskFormData,"audit");case 17:t.$http.get("/app/flowable/task/historicTaskList?procInsId=".concat(t.procInsId)).then((function(e){var a=e.data;t.historicTaskList=a.historicTaskList.reverse()}));case 18:case"end":return e.stop()}}),e)})))()},components:{userSelect:n.default,TestActivitiLeaveForm:o.default,PreviewForm:r.default},data:function(){return{flow:null,tabIndex:0,form:null,formType:"",formUrl:"",taskSelectedTab:"frist",historicTaskList:[],procDefId:"",procInsId:"",formReadOnly:!1,procDefKey:"",taskId:"",formData:[],taskDefKey:"",status:"",title:"",businessId:""}},methods:{tabSelect:function(t){this.procInsId?this.$refs.chart1.init():this.$refs.chart2.init(),this.tabIndex=parseInt(t.currentTarget.dataset.id)},setData:function(t,e){var a=this;this.formData.forEach((function(e){var s=t.filter((function(t){return e.model===t.id}))[0];s?(a.isObjectValue(e)&&s.value&&"string"===typeof s.value?e.value=JSON.parse(s.value):e.value=s.value,e.readable=s.readable,e.writable=!1):e.readable=!1}))},isObjectValue:function(t){return!!("checkbox"===t.type||"slider"===t.type||"switch"===t.type||"rate"===t.type||"imgupload"===t.type||"select"===t.type&&t.options.multiple||"fileupload"===t.type)}}};e.default=c},b608:function(t,e,a){"use strict";var s=a("28e5"),i=a.n(s);i.a},d8784:function(t,e,a){"use strict";var s,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("cu-custom",{attrs:{bgColor:"bg-blue",isBack:!0}},[a("template",{attrs:{slot:"backText"},slot:"backText"},[t._v("返回")]),a("template",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.title))])],2),a("v-uni-view",{staticClass:"bg-white nav fixed flex text-center",style:[{top:t.CustomBar+"px"}]},[a("v-uni-view",{staticClass:"cu-item flex-sub",class:0==t.tabIndex?"text-blue cur":"",attrs:{"data-id":"0"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tabSelect.apply(void 0,arguments)}}},[t._v("表单信息")]),t.procInsId?a("v-uni-view",{staticClass:"cu-item flex-sub",class:2==t.tabIndex?"text-blue cur":"",attrs:{"data-id":"2"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tabSelect.apply(void 0,arguments)}}},[t._v("流转记录")]):t._e(),a("v-uni-view",{staticClass:"cu-item flex-sub",class:1==t.tabIndex?"text-blue cur":"",attrs:{"data-id":"1"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tabSelect.apply(void 0,arguments)}}},[t._v("流程图")])],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0===t.tabIndex,expression:"0 === tabIndex"}]},[a("v-uni-scroll-view",{staticClass:"page",attrs:{"scroll-y":!0}},[a("v-uni-view",{staticClass:" bg-white margin-top"},[a(t.form,{ref:"form",tag:"component",class:t.formReadOnly?"readonly":"",attrs:{formReadOnly:t.formReadOnly,businessId:t.businessId}}),"2"!==t.formType?a("PreviewForm",{ref:"form",attrs:{formData:t.formData,processDefinitionId:t.procDefId,edit:!1}}):t._e()],1),a("v-uni-view",{staticClass:"cu-tabbar-height"})],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1===t.tabIndex,expression:"1 === tabIndex"}]},[a("v-uni-view",{staticClass:"padding bg-white margin-top"},[t.procInsId?a("flow-chart",{ref:"chart1",attrs:{processInstanceId:t.procInsId}}):t._e(),t.procInsId?t._e():a("flow-chart",{ref:"chart2",attrs:{processDefId:t.procDefId}})],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2===t.tabIndex,expression:"2 === tabIndex"}]},[a("v-uni-view",{staticClass:"padding bg-white margin-top"},t._l(t.historicTaskList,(function(e,s){return a("v-uni-view",{key:s,staticClass:"cu-timeline"},[a("v-uni-view",{staticClass:"cu-time"},[t._v(t._s(t._f("formatDate")(e.histIns.startTime,"MM-DD")))]),a("v-uni-view",{staticClass:"cu-item text-blue"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"cu-capsule radius"},[a("v-uni-view",{staticClass:"cu-tag bg-cyan"},[t._v(t._s(e.histIns.activityName))])],1),a("v-uni-view",{staticClass:"margin-top"},[t._v("审批人 ： "+t._s(e.assigneeName))]),a("v-uni-view",{staticClass:"margin-top"},[t._v("办理状态 ："),a("v-uni-view",{staticClass:"cu-tag bg-blue"},[t._v(t._s(e.comment.status))])],1),a("v-uni-view",{staticClass:"margin-top"},[t._v("审批意见 ： "+t._s(e.comment.message))]),a("v-uni-view",{staticClass:"margin-top"},[t._v("开始时间 : "+t._s(t._f("formatDate")(e.histIns.startTime)))]),a("v-uni-view",{staticClass:"margin-top"},[t._v("结束时间 : "+t._s(t._f("formatDate")(e.histIns.endTime)))]),a("v-uni-view",{staticClass:"margin-top"},[t._v("用时 : "+t._s(e.durationTime||"0秒"))])],1)],1)],1)})),1)],1)],1)},n=[];a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return s}))},ed54:function(t,e,a){"use strict";a.r(e);var s=a("880d"),i=a.n(s);for(var n in s)"default"!==n&&function(t){a.d(e,t,(function(){return s[t]}))}(n);e["default"]=i.a}}]);